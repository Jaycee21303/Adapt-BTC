<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdaptBTC | Bitcoin Wallet Generator</title>
    <style>
body {
  background: #ffffff;
  font-family: Arial, sans-serif;
  padding: 20px;
  color: #111;
}

.container {
  max-width: 650px;
  margin: auto;
  padding: 20px;
  border-radius: 12px;
  border: 1px solid #e0e0e0;
  background: #fff;
}

h2, h3 {
  color: #1A73E8;
}

.warning {
  background: #ffe5e5;
  border-left: 4px solid #ff0000;
  padding: 12px;
  margin-bottom: 15px;
  font-weight: bold;
}

.output {
  padding: 12px;
  background: #f7f7f7;
  border-radius: 8px;
  margin-bottom: 10px;
  word-wrap: break-word;
}

button {
  padding: 8px 14px;
  margin-bottom: 15px;
  border-radius: 6px;
  border: none;
  background: #1A73E8;
  color: #fff;
  cursor: pointer;
}

button:hover {
  background: #155bb5;
}

.generate-btn {
  width: 100%;
  padding: 12px;
  font-size: 16px;
}
    </style>

    <!-- 1. tiny-secp256k1 FIRST -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tiny-secp256k1/2.2.1/tiny-secp256k1.min.js"></script>

    <!-- 2. bitcoinjs-lib SECOND -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bitcoinjs-lib/6.1.5/bitcoinjs-lib.min.js"></script>

    <!-- 3. Initialize ECC immediately -->
    <script>
        window.bitcoinjs.initEccLib(window.tinySecp256k1);
    </script>

    <!-- 4. BIP39 + QR Code libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bip39/3.1.0/bip39.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
</head>
<body>

<div class="container">

    <h2>Bitcoin Wallet Generator</h2>

    <div class="warning">
        ⚠️ Never share your seed phrase or private key with anyone.
    </div>

    <button class="generate-btn" onclick="generateWallet()">Generate New Wallet</button>

    <h3>Bitcoin Address</h3>
    <div class="output" id="address"></div>
    <button onclick="copyText('address')">Copy</button>
    <canvas id="qr"></canvas>

    <h3>12-Word Seed Phrase</h3>
    <div class="output" id="seed"></div>
    <button onclick="copyText('seed')">Copy</button>

    <h3>Private Key (WIF)</h3>
    <div class="output" id="private"></div>
    <button onclick="copyText('private')">Copy</button>

    <button class="download-btn" onclick="downloadBackup()">Download Backup</button>

</div>

<script>
const bitcoin = window.bitcoinjs;

async function generateWallet() {

    // Seed phrase
    const seedPhrase = bip39.generateMnemonic(128);

    // Convert mnemonic → seed
    const seedBuffer = await bip39.mnemonicToSeed(seedPhrase);

    // sha256(seed) → private key
    const hash = bitcoin.crypto.sha256(seedBuffer);

    const keyPair = bitcoin.ECPair.fromPrivateKey(hash);
    const privateKeyWIF = keyPair.toWIF();

    const { address } = bitcoin.payments.p2pkh({
        pubkey: keyPair.publicKey
    });

    // Update UI
    document.getElementById("seed").textContent = seedPhrase;
    document.getElementById("private").textContent = privateKeyWIF;
    document.getElementById("address").textContent = address;

    // QR Code
    new QRious({
        element: document.getElementById("qr"),
        value: address,
        size: 220
    });
}

function copyText(id) {
    navigator.clipboard.writeText(
        document.getElementById(id).textContent
    );
}

function downloadBackup() {

    const seed = document.getElementById("seed").textContent;
    const priv = document.getElementById("private").textContent;
    const addr = document.getElementById("address").textContent;
    const timestamp = new Date().toLocaleString();

    const data =
`AdaptBTC Wallet Backup
-----------------------
Address: ${addr}
Seed Phrase: ${seed}
Private Key (WIF): ${priv}

Generated: ${timestamp}

KEEP THIS FILE SECURE.`;

    const blob = new Blob([data], { type: "text/plain" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "AdaptBTC-Wallet-Backup.txt";
    a.click();
}
</script>

</body>
</html>
