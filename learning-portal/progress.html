<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Progress</title>
  <link rel="stylesheet" href="/learning-portal/assets/css/portal.css">
</head>
<body>
  <div class="main-shell">
    <div class="navbar">
      <div class="logo-text">Adapt<span style="color:#1e88e5;">BTC</span></div>
      <div class="nav-links">
        <a class="btn btn-secondary" href="/learning-portal/dashboard.html">Dashboard</a>
      </div>
    </div>
    <div class="card">
      <div class="badge">Progress</div>
      <h2>Lesson & Quiz Status</h2>
      <table class="table" id="progress-table"></table>
    </div>
  </div>
  <script type="module">
    import { sessionGuard, loadProgress } from './assets/js/portal-auth.js';
    await sessionGuard('learning');
    const table = document.getElementById('progress-table');
    const progress = await loadProgress();
    const rows = ['Lesson','Quiz'].map((type, idx) => {
      const entries = type === 'Lesson' ? progress.lessons || {} : progress.quizzes || {};
      return Object.keys(entries).sort((a,b)=>Number(a)-Number(b)).map(key => {
        const val = entries[key];
        const status = typeof val === 'object' ? `${val.score}% (${val.passed ? 'passed' : 'retry'})` : val;
        return `<tr><th>${type} ${key}</th><td>${status}</td></tr>`;
      }).join('');
    }).join('');
    table.innerHTML = rows || '<tr><td>No progress yet. Start with Lesson 1.</td></tr>';
  </script>
</body>
</html>
